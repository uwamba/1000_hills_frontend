(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2766],{3320:(e,t,l)=>{"use strict";l.r(t),l.d(t,{default:()=>r});var a=l(5155),o=l(2115);let n="https://staging.livatrip.com/api",r=()=>{let[e,t]=(0,o.useState)({full_name:"",email:"",phone:"",property_id:""}),[l,r]=(0,o.useState)(""),[s,i]=(0,o.useState)("form"),[d,c]=(0,o.useState)(!1),[h,m]=(0,o.useState)(!1),[u,p]=(0,o.useState)(!1),x=l=>{t({...e,[l.target.name]:l.target.value})},b=()=>{p(!1),t({full_name:"",email:"",phone:"",property_id:""}),r(""),i("form")},g=async()=>{try{c(!0);let t=await fetch("".concat(n,"/send-otp"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e.email})});if(!t.ok){let e=await t.json();throw console.error("Failed to send OTP:",e),Error("Failed to send OTP")}i("otp")}catch(e){alert("Error sending OTP"),console.error("Error:",e)}finally{c(!1)}},f=async()=>{try{if(m(!0),!(await fetch("".concat(n,"/verify-otp"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e.email,otp:l})})).ok)throw Error("Invalid OTP");if(!(await fetch("".concat(n,"/bookings"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).ok)throw Error("Booking failed");i("success")}catch(e){alert("Verification or booking failed"),console.error(e)}finally{m(!1)}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{onClick:()=>{p(!0),i("form")},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Book Visit"}),u&&(0,a.jsx)("div",{className:"fixed inset-0 z-50 bg-black bg-opacity-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-md p-6 relative",children:[(0,a.jsxs)("p",{className:"text-xs text-gray-400 mb-2",children:["Step: ",s]}),(0,a.jsx)("button",{onClick:b,className:"absolute top-2 right-2 text-gray-500 hover:text-gray-700 text-xl",children:"\xd7"}),"form"===s&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Book a Visit"}),(0,a.jsx)("input",{type:"text",name:"full_name",placeholder:"Full Name",value:e.full_name,onChange:x,className:"w-full p-2 border rounded mb-2"}),(0,a.jsx)("input",{type:"email",name:"email",placeholder:"Email",value:e.email,onChange:x,className:"w-full p-2 border rounded mb-2"}),(0,a.jsx)("input",{type:"text",name:"phone",placeholder:"Phone",value:e.phone,onChange:x,className:"w-full p-2 border rounded mb-4"}),(0,a.jsx)("button",{type:"button",onClick:g,disabled:d,className:"w-full p-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:d?"Sending OTP...":"Continue"})]}),"otp"===s&&(0,a.jsxs)("div",{className:"bg-yellow-50 p-4 rounded",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Enter OTP"}),(0,a.jsxs)("p",{className:"text-sm text-gray-600 mb-3",children:["Code sent to ",(0,a.jsx)("strong",{children:e.email})]}),(0,a.jsx)("input",{type:"text",placeholder:"Enter OTP",value:l,onChange:e=>r(e.target.value),className:"w-full p-2 border rounded mb-3"}),(0,a.jsx)("button",{onClick:f,disabled:h,className:"w-full p-2 bg-green-600 text-white rounded hover:bg-green-700",children:h?"Verifying...":"Verify & Book"})]}),"success"===s&&(0,a.jsxs)("div",{className:"text-center p-4",children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-green-700 mb-2",children:"Booking Confirmed!"}),(0,a.jsx)("p",{className:"text-gray-600",children:"We'll be in touch shortly."}),(0,a.jsx)("button",{onClick:b,className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Close"})]})]})})]})}},7294:(e,t,l)=>{Promise.resolve().then(l.bind(l,3320))}},e=>{var t=t=>e(e.s=t);e.O(0,[8441,1684,7358],()=>t(7294)),_N_E=e.O()}]);