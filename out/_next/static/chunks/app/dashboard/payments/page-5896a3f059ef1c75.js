(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[889],{8023:(t,e,a)=>{"use strict";a.r(e),a.d(e,{default:()=>l});var s=a(5155),r=a(2115);let l=()=>{let[t,e]=(0,r.useState)([]),[a,l]=(0,r.useState)(!1),[c,n]=(0,r.useState)(""),[o,d]=(0,r.useState)(""),[x,i]=(0,r.useState)(""),m=async()=>{try{l(!0);let t=localStorage.getItem("authToken"),a=new URLSearchParams;c&&o&&(a.append("from_date",c),a.append("to_date",o)),x&&a.append("month",x);let s=await fetch("".concat("https://test.livatrip.com","/payments?").concat(a.toString()),{headers:{Authorization:"Bearer ".concat(t)}});if(!s.ok)throw Error("Failed to fetch payments");let r=await s.json();console.log("Fetched payments:",r);let n=t=>{var e;return{...t,currency_code:null!=(e=t.currency_code)?e:"USD"}},d=[];Array.isArray(r)?d=r.map(n):r&&Array.isArray(r.data)&&(d=r.data.map(n)),d.sort((t,e)=>new Date(e.created_at).getTime()-new Date(t.created_at).getTime()),e(d)}catch(t){console.error("Error fetching payments:",t)}finally{l(!1)}},h=async t=>{try{let e=localStorage.getItem("authToken");if(!e)return void alert("Not authenticated");let a=await fetch("".concat("https://test.livatrip.com","/payments/").concat(t,"/status"),{headers:{Authorization:"Bearer ".concat(e)}});if(!a.ok){console.error("Failed to check status"),alert("Failed to check status");return}let s=await a.json();console.log("Payment status response:",s),s.success&&s.data?alert("Status: ".concat(s.data.status,"\nAmount: ").concat(s.data.amount," ").concat(s.data.currency_code)):alert("Status check failed: ".concat(s.message))}catch(t){console.error("Error checking status:",t),alert("An error occurred while checking status.")}};return(0,r.useEffect)(()=>{m()},[]),(0,s.jsxs)("div",{className:"p-6 bg-white min-h-screen",children:[(0,s.jsx)("h1",{className:"text-3xl font-semibold text-gray-800 mb-6",children:"Payments"}),(0,s.jsxs)("div",{className:"mb-6 flex flex-wrap gap-4 items-end",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"From Date"}),(0,s.jsx)("input",{type:"date",value:c,onChange:t=>n(t.target.value),className:"border rounded p-2 text-sm text-black"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"To Date"}),(0,s.jsx)("input",{type:"date",value:o,onChange:t=>d(t.target.value),className:"border rounded p-2 text-sm text-black"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Month"}),(0,s.jsx)("input",{type:"month",value:x,onChange:t=>i(t.target.value),className:"border rounded p-2 text-sm text-black"})]}),(0,s.jsx)("button",{onClick:m,className:"bg-blue-500 hover:bg-blue-600 text-white text-sm px-4 py-2 rounded",children:"Apply Filters"})]}),a?(0,s.jsx)("p",{className:"text-gray-500",children:"Loading..."}):0===t.length?(0,s.jsx)("p",{className:"text-gray-500",children:"No payments found."}):(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"min-w-full table-auto border border-gray-200",children:[(0,s.jsx)("thead",{className:"bg-gray-100",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-4 py-2 text-left text-sm font-semibold text-gray-700",children:"Transaction"}),(0,s.jsx)("th",{className:"px-4 py-2 text-left text-sm font-semibold text-gray-700",children:"Amount"}),(0,s.jsx)("th",{className:"px-4 py-2 text-left text-sm font-semibold text-gray-700",children:"Currency"}),(0,s.jsx)("th",{className:"px-4 py-2 text-left text-sm font-semibold text-gray-700",children:"Account"}),(0,s.jsx)("th",{className:"px-4 py-2 text-left text-sm font-semibold text-gray-700",children:"Type"}),(0,s.jsx)("th",{className:"px-4 py-2 text-left text-sm font-semibold text-gray-700",children:"Status"}),(0,s.jsx)("th",{className:"px-4 py-2 text-left text-sm font-semibold text-gray-700",children:"Client"}),(0,s.jsx)("th",{className:"px-4 py-2 text-left text-sm font-semibold text-gray-700",children:"Actions"})]})}),(0,s.jsx)("tbody",{children:t.map(t=>{var e,a;return(0,s.jsxs)("tr",{className:"border-t border-gray-200",children:[(0,s.jsx)("td",{className:"px-4 py-2 text-sm text-gray-700",children:t.transaction_id}),(0,s.jsx)("td",{className:"px-4 py-2 text-sm text-gray-700",children:t.amount_paid.toLocaleString()}),(0,s.jsx)("td",{className:"px-4 py-2 text-sm text-gray-700",children:t.currency_code}),(0,s.jsx)("td",{className:"px-4 py-2 text-sm text-gray-700",children:t.account}),(0,s.jsx)("td",{className:"px-4 py-2 text-sm text-gray-700",children:t.type}),(0,s.jsx)("td",{className:"px-4 py-2 text-sm",children:(0,s.jsx)("span",{className:"inline-block px-2 py-0.5 rounded text-xs font-semibold ".concat("success"===t.status?"bg-green-100 text-green-700":"pending"===t.status?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"),children:t.status})}),(0,s.jsx)("td",{className:"px-4 py-2 text-sm text-gray-700",children:null!=(a=null==(e=t.client)?void 0:e.name)?a:"-"}),(0,s.jsx)("td",{className:"px-4 py-2 text-sm",children:(0,s.jsx)("button",{onClick:()=>h(t.id),className:"bg-blue-500 hover:bg-blue-600 text-white text-xs px-3 py-1 rounded",children:"Check Status"})})]},t.id)})})]})})]})}},8582:(t,e,a)=>{Promise.resolve().then(a.bind(a,8023))}},t=>{t.O(0,[8441,5964,7358],()=>t(t.s=8582)),_N_E=t.O()}]);