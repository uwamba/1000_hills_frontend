(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8512],{3804:(e,a,n)=>{Promise.resolve().then(n.bind(n,5426))},5426:(e,a,n)=>{"use strict";n.r(a),n.d(a,{default:()=>i});var t=n(5155),r=n(2115),s=n(2200),l=n(9509);let o={name:"",number_of_bedroom:1,kitchen_inside:!1,kitchen_outside:!1,number_of_floor:1,address:"",coordinate:{lat:"",lng:""},annexes:"",description:"",status:"",swimming_pool:!1,laundry:!1,gym:!1,room_service:!1,sauna_massage:!1,price_per_night:"",price_per_month:"",contract:"",apartment_owner_id:""};function i(){let[e,a]=(0,r.useState)({...o}),[n,i]=(0,r.useState)([]),[d,c]=(0,r.useState)(!1),[m,p]=(0,r.useState)(null),[u,h]=(0,r.useState)([]),[b,x]=(0,r.useState)(!0),{isLoaded:g}=(0,s.KD)({googleMapsApiKey:l.env.NEXT_PUBLIC_GOOGLE_MAPS_API_KEY}),_={lat:parseFloat(e.coordinate.lat)||-1.9441,lng:parseFloat(e.coordinate.lng)||30.0619};(0,r.useEffect)(()=>{(async()=>{try{let e=localStorage.getItem("authToken")||"",a=await fetch("".concat("https://staging.livatrip.com/api","/apartment-owners/names"),{headers:{Authorization:"Bearer ".concat(e)}});if(a.ok){let e=await a.json();h(e)}else console.error("Failed to fetch owners:",a.statusText),h([])}catch(e){console.error("Error fetching owners:",e),h([])}finally{x(!1)}})()},[]);let f=e=>{let{name:n,value:t,type:r}=e.target;if("checkbox"===r){let t=e.target;a(e=>({...e,[n]:t.checked}))}else"number_of_bedroom"===n||"number_of_floor"===n?a(e=>({...e,[n]:parseInt(t)||1})):"apartment_owner_id"===n?a(e=>({...e,apartment_owner_id:t})):a(e=>({...e,[n]:t}))},j=(e,a)=>{if(a.target.files&&a.target.files[0]){let t=[...n];t[e]=a.target.files[0],i(t)}},v=async t=>{if(t.preventDefault(),!e.apartment_owner_id)return void alert("Please select an apartment owner.");let r=new FormData;r.append("name",e.name),r.append("address",e.address),r.append("description",e.description),r.append("number_of_bedroom",e.number_of_bedroom.toString()),r.append("kitchen_inside",e.kitchen_inside?"1":"0"),r.append("kitchen_outside",e.kitchen_outside?"1":"0"),r.append("number_of_floor",e.number_of_floor.toString()),r.append("status",e.status),r.append("coordinate","".concat(e.coordinate.lat,",").concat(e.coordinate.lng)),r.append("annexes",e.annexes),r.append("swimming_pool",e.swimming_pool?"1":"0"),r.append("laundry",e.laundry?"1":"0"),r.append("gym",e.gym?"1":"0"),r.append("room_service",e.room_service?"1":"0"),r.append("sauna_massage",e.sauna_massage?"1":"0"),r.append("price_per_night",e.price_per_night),r.append("price_per_month",e.price_per_month),r.append("apartment_owner_id",e.apartment_owner_id),m&&r.append("contract",m),n.forEach(e=>{e instanceof File&&e.size>0&&r.append("photos[]",e)});try{let e=localStorage.getItem("authToken")||"",n=await fetch("".concat("https://staging.livatrip.com/api","/apartments"),{method:"POST",headers:{Authorization:"Bearer ".concat(e)},body:r});if(n.ok)alert("Apartment successfully added!"),a(o),i([]),p(null);else{let e=await n.text();console.error("Server error:",e),alert("Failed to add apartment.")}}catch(e){console.error("Error:",e),alert("There was an error adding the apartment.")}};return(0,t.jsxs)("form",{onSubmit:v,className:"max-w-4xl mx-auto p-6 bg-white shadow-md rounded space-y-6 text-gray-900",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold",children:"Add New Apartment"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Apartment Owner"}),b?(0,t.jsx)("p",{children:"Loading owners..."}):(0,t.jsxs)("select",{name:"apartment_owner_id",value:e.apartment_owner_id,onChange:f,required:!0,className:"w-full p-2 border border-gray-300 rounded",children:[(0,t.jsx)("option",{value:"",children:"Select Owner"}),u.map(e=>(0,t.jsx)("option",{value:e.id.toString(),children:e.name},e.id))]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Apartment Name"}),(0,t.jsx)("input",{type:"text",name:"name",value:e.name,onChange:f,required:!0,className:"w-full p-2 border border-gray-300 rounded"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Address"}),(0,t.jsx)("input",{type:"text",name:"address",value:e.address,onChange:f,required:!0,className:"w-full p-2 border border-gray-300 rounded"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Price Per Night"}),(0,t.jsx)("input",{type:"number",name:"price_per_night",value:e.price_per_night,onChange:n=>a({...e,price_per_night:n.target.value}),required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Monthly Price"}),(0,t.jsx)("input",{type:"number",name:"price_per_month",value:e.price_per_month,onChange:n=>a({...e,price_per_month:n.target.value}),required:!0})]}),(0,t.jsxs)("div",{className:"md:col-span-2",children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Description"}),(0,t.jsx)("textarea",{name:"description",value:e.description,onChange:f,rows:3,required:!0,className:"w-full p-2 border border-gray-300 rounded"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Number of Bedrooms"}),(0,t.jsx)("input",{type:"number",name:"number_of_bedroom",value:e.number_of_bedroom,onChange:f,min:1,required:!0,className:"w-full p-2 border border-gray-300 rounded"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Number of Floors"}),(0,t.jsx)("input",{type:"number",name:"number_of_floor",value:e.number_of_floor,onChange:f,min:1,required:!0,className:"w-full p-2 border border-gray-300 rounded"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("input",{type:"checkbox",name:"kitchen_inside",checked:e.kitchen_inside,onChange:f,className:"h-4 w-4"}),(0,t.jsx)("label",{children:"Kitchen Inside"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("input",{type:"checkbox",name:"kitchen_outside",checked:e.kitchen_outside,onChange:f,className:"h-4 w-4"}),(0,t.jsx)("label",{children:"Kitchen Outside"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Annexes"}),(0,t.jsx)("input",{type:"text",name:"annexes",value:e.annexes,onChange:f,className:"w-full p-2 border border-gray-300 rounded"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Status"}),(0,t.jsxs)("select",{name:"status",value:e.status,onChange:f,required:!0,className:"w-full p-2 border border-gray-300 rounded",children:[(0,t.jsx)("option",{value:"",children:"Select Status"}),(0,t.jsx)("option",{value:"active",children:"Active"}),(0,t.jsx)("option",{value:"inactive",children:"Inactive"})]})]}),(0,t.jsx)("div",{className:"md:col-span-2 grid grid-cols-1 sm:grid-cols-2 gap-3 pt-4",children:[{label:"Swimming Pool",name:"swimming_pool"},{label:"Laundry",name:"laundry"},{label:"Gym",name:"gym"},{label:"Room Service",name:"room_service"},{label:"Sauna Massage",name:"sauna_massage"}].map(a=>(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("input",{type:"checkbox",name:a.name,checked:e[a.name],onChange:f,className:"h-4 w-4"}),(0,t.jsx)("label",{children:a.label})]},a.name))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Photos"}),(0,t.jsx)("div",{className:"space-y-2",children:n.map((e,a)=>(0,t.jsx)("input",{type:"file",accept:"image/*",onChange:e=>j(a,e),className:"block w-full text-sm border border-gray-300 rounded file:mr-4 file:py-2 file:px-4 file:rounded file:border-0 file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"},a))}),(0,t.jsx)("button",{type:"button",onClick:()=>{i([...n,new File([],"")])},className:"mt-3 px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded hover:bg-blue-700",children:"+ Add Another Photo"})]}),(0,t.jsx)("div",{children:(0,t.jsx)("button",{type:"button",onClick:()=>c(!d),className:"mt-2 px-4 py-2 text-sm font-medium text-white bg-green-600 rounded hover:bg-green-700",children:d?"Close Map":"Set Location on Map"})}),g&&d&&(0,t.jsx)("div",{className:"h-64 mt-4 border rounded overflow-hidden",children:(0,t.jsx)(s.u6,{center:_,zoom:15,mapContainerClassName:"w-full h-full",onClick:e=>{var n,t,r,s;let l=null!=(r=null==(n=e.latLng)?void 0:n.lat().toString())?r:"",o=null!=(s=null==(t=e.latLng)?void 0:t.lng().toString())?s:"";l&&o&&a(e=>({...e,coordinate:{lat:l,lng:o}}))},children:(0,t.jsx)(s.pH,{position:_})})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"contract",className:"block text-sm font-medium text-gray-700",children:"Contract File (PDF/DOC)"}),(0,t.jsx)("input",{type:"file",name:"contract",accept:".pdf,.doc,.docx",onChange:e=>{e.target.files&&e.target.files[0]&&p(e.target.files[0])},className:"w-full rounded-md border px-3 py-2 focus:ring-2 focus:ring-blue-500"})]}),(0,t.jsx)("div",{children:(0,t.jsx)("button",{type:"submit",className:"w-full py-3 px-4 text-center font-medium bg-blue-600 hover:bg-blue-700 text-white rounded",children:"Submit Apartment"})})]})}}},e=>{var a=a=>e(e.s=a);e.O(0,[6084,8441,1684,7358],()=>a(3804)),_N_E=e.O()}]);