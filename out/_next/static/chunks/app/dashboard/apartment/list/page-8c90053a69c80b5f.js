(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3269],{2737:(e,t,a)=>{Promise.resolve().then(a.bind(a,7392))},7392:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>l});var s=a(5155),o=a(2115),r=a(9509);function l(){var e;let[t,a]=(0,o.useState)([]),[l,n]=(0,o.useState)(!0),[c,i]=(0,o.useState)(1),[d,p]=(0,o.useState)(1),[h,m]=(0,o.useState)(!1),[u,x]=(0,o.useState)(null),[b,f]=(0,o.useState)([]),j=localStorage.getItem("authToken"),g=async e=>{try{n(!0);let t=await fetch("".concat("https://backtest.livatrip.com/api","/apartments?page=").concat(e),{headers:{Authorization:"Bearer ".concat(j)}});if(!t.ok)throw Error("Failed to fetch apartments");let s=await t.json();a(s.data),i(s.current_page),p(s.last_page)}catch(e){console.error("Error fetching apartments:",e)}finally{n(!1)}};(0,o.useEffect)(()=>{g(c)},[c]);let N=async e=>{if(e.preventDefault(),!u)return;let t=new FormData(e.currentTarget);t.append("_method","PUT"),b.forEach(e=>{t.append("photos[]",e)});try{if(!(await fetch("".concat("https://backtest.livatrip.com/api","/apartments/").concat(u.id),{method:"POST",headers:{Authorization:"Bearer ".concat(j)},body:t})).ok)throw Error("Failed to update apartment");m(!1),f([]),g(c)}catch(e){console.error("Error updating apartment:",e)}},w=async e=>{if(confirm("Are you sure you want to delete this apartment?"))try{if(!(await fetch("".concat("https://backtest.livatrip.com/api","/apartments/").concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(j)}})).ok)throw Error("Failed to delete apartment");g(c)}catch(e){console.error("Error deleting apartment:",e)}},y=async e=>{if(confirm("Are you sure you want to delete this photo?"))try{if(!(await fetch("".concat("https://backtest.livatrip.com/api","/photos/").concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(j)}})).ok)throw Error("Failed to delete photo");u&&x({...u,photos:u.photos.filter(t=>t.id!==e)})}catch(e){console.error("Error deleting photo:",e)}},v=r.env.NEXT_PUBLIC_IMAGE_BASE_URL_STORAGE||"http://localhost:3000/images";return(0,s.jsxs)("div",{className:"p-6 bg-gray-50 min-h-screen text-black",children:[(0,s.jsx)("h1",{className:"text-3xl font-extrabold text-black mb-6",children:"Apartment List"}),l?(0,s.jsx)("div",{children:"Loading apartments..."}):0===t.length?(0,s.jsx)("div",{children:"No apartments found."}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map(e=>{var t;return(0,s.jsxs)("div",{className:"bg-white p-4 rounded shadow",children:[(0,s.jsx)("img",{src:e.photos[0]?"".concat(v,"/").concat(e.photos[0].url):"/placeholder.jpg",className:"w-full h-48 object-cover rounded"}),(0,s.jsx)("h2",{className:"text-xl font-bold mt-2",children:e.name}),(0,s.jsx)("p",{children:e.location}),(0,s.jsx)("p",{children:e.description}),(0,s.jsxs)("p",{children:["Rooms: ",e.rooms]}),(0,s.jsxs)("p",{children:["Status: ",null!=(t=e.status)?t:"N/A"]}),e.deleted_on&&(0,s.jsxs)("p",{className:"text-red-600",children:["Deleted On: ",new Date(e.deleted_on).toLocaleDateString()]}),(0,s.jsxs)("div",{className:"mt-2 flex space-x-2",children:[(0,s.jsx)("button",{className:"bg-yellow-500 text-white px-3 py-1 rounded",onClick:()=>{x(e),f([]),m(!0)},children:"Edit"}),(0,s.jsx)("button",{className:"bg-red-600 text-white px-3 py-1 rounded",onClick:()=>w(e.id),children:"Delete"})]})]},e.id)})}),(0,s.jsxs)("div",{className:"mt-6 flex justify-center space-x-4",children:[(0,s.jsx)("button",{onClick:()=>c>1&&i(c-1),disabled:1===c,className:"bg-indigo-600 text-white px-4 py-2 rounded disabled:opacity-50",children:"Previous"}),(0,s.jsxs)("span",{children:["Page ",c," of ",d]}),(0,s.jsx)("button",{onClick:()=>c<d&&i(c+1),disabled:c===d,className:"bg-indigo-600 text-white px-4 py-2 rounded disabled:opacity-50",children:"Next"})]})]}),h&&u&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,s.jsxs)("div",{className:"bg-white p-6 rounded-lg w-full max-w-lg shadow-lg overflow-y-auto max-h-screen text-black",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Edit Apartment"}),(0,s.jsxs)("form",{onSubmit:N,encType:"multipart/form-data",children:[(0,s.jsx)("input",{name:"name",defaultValue:u.name,className:"w-full p-2 mb-2 border"}),(0,s.jsx)("input",{name:"location",defaultValue:u.location,className:"w-full p-2 mb-2 border"}),(0,s.jsx)("textarea",{name:"description",defaultValue:u.description,className:"w-full p-2 mb-2 border"}),(0,s.jsx)("input",{name:"rooms",type:"number",defaultValue:u.rooms,className:"w-full p-2 mb-2 border"}),(0,s.jsxs)("select",{name:"status",defaultValue:null!=(e=u.status)?e:"",className:"w-full p-2 mb-4 border",children:[(0,s.jsx)("option",{value:"",children:"Select status"}),(0,s.jsx)("option",{value:"active",children:"Active"}),(0,s.jsx)("option",{value:"inactive",children:"Inactive"})]}),(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("label",{className:"block font-medium mb-1",children:"Current Photo(s)"}),(0,s.jsx)("div",{className:"flex gap-2 flex-wrap",children:u.photos.map(e=>(0,s.jsxs)("div",{className:"relative group",children:[(0,s.jsx)("img",{src:"".concat(v,"/").concat(e.url),className:"w-24 h-24 object-cover rounded border"}),(0,s.jsx)("button",{type:"button",onClick:()=>y(e.id),className:"absolute top-1 right-1 bg-red-600 text-white text-xs rounded-full px-2 py-1",children:"âœ•"})]},e.id))})]}),(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Upload New Photo(s)"}),(0,s.jsx)("div",{className:"space-y-2",children:b.map((e,t)=>(0,s.jsx)("input",{type:"file",accept:"image/*",name:"photos",onChange:e=>((e,t)=>{let a=t.target.files;if(!a)return;let s=[...b];s[e]=a[0],f(s)})(t,e),className:"block w-full border rounded p-1"},t))}),(0,s.jsx)("button",{type:"button",onClick:()=>{f([...b,new File([],"")])},className:"mt-2 px-3 py-1 bg-blue-600 text-white rounded",children:"+ Add Another Photo"})]}),(0,s.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,s.jsx)("button",{type:"button",onClick:()=>{m(!1),f([])},className:"bg-gray-500 text-white px-4 py-2 rounded",children:"Cancel"}),(0,s.jsx)("button",{type:"submit",className:"bg-blue-600 text-white px-4 py-2 rounded",children:"Save"})]})]})]})})]})}}},e=>{e.O(0,[8441,5964,7358],()=>e(e.s=2737)),_N_E=e.O()}]);