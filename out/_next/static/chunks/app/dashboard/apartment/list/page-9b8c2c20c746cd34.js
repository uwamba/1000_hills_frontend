(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[269],{4143:(e,t,a)=>{Promise.resolve().then(a.bind(a,5011))},5011:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>o});var s=a(5155),l=a(2115);function o(){var e;let[t,a]=(0,l.useState)([]),[o,r]=(0,l.useState)(!0),[n,c]=(0,l.useState)(1),[i,d]=(0,l.useState)(1),[p,m]=(0,l.useState)(!1),[h,u]=(0,l.useState)(null),[x,b]=(0,l.useState)([]),f=async e=>{try{r(!0);let t=await fetch("".concat("https://staging.livatrip.com/api","/apartments?page=").concat(e));if(!t.ok)throw Error("Failed to fetch apartments");let s=await t.json();a(s.data),c(s.current_page),d(s.last_page)}catch(e){console.error("Error fetching apartments:",e)}finally{r(!1)}};(0,l.useEffect)(()=>{f(n)},[n]);let g=async e=>{if(e.preventDefault(),!h)return;let t=new FormData(e.currentTarget);t.append("_method","PUT"),x.forEach(e=>{t.append("photos[]",e)});try{if(!(await fetch("".concat("https://staging.livatrip.com/api","/apartments/").concat(h.id),{method:"POST",body:t})).ok)throw Error("Failed to update apartment");m(!1),b([]),f(n)}catch(e){console.error("Error updating apartment:",e)}},j=async e=>{if(confirm("Are you sure you want to delete this apartment?"))try{if(!(await fetch("".concat("https://staging.livatrip.com/api","/apartments/").concat(e),{method:"DELETE"})).ok)throw Error("Failed to delete apartment");f(n)}catch(e){console.error("Error deleting apartment:",e)}},w=async e=>{if(confirm("Are you sure you want to delete this photo?"))try{if(!(await fetch("".concat("https://staging.livatrip.com/api","/photos/").concat(e),{method:"DELETE"})).ok)throw Error("Failed to delete photo");h&&u({...h,photos:h.photos.filter(t=>t.id!==e)})}catch(e){console.error("Error deleting photo:",e)}},N=(e,t)=>{let a=t.target.files;if(!a)return;let s=[...x];s[e]=a[0],b(s)},y="http://127.0.0.1:8000/storage";return(0,s.jsxs)("div",{className:"p-6 bg-gray-50 min-h-screen text-black",children:[(0,s.jsx)("h1",{className:"text-3xl font-extrabold text-black mb-6",children:"Apartment List"}),o?(0,s.jsx)("div",{children:"Loading apartments..."}):0===t.length?(0,s.jsx)("div",{children:"No apartments found."}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map(e=>{var t;return(0,s.jsxs)("div",{className:"bg-white p-4 rounded shadow",children:[(0,s.jsx)("img",{src:e.photos[0]?"".concat(y,"/").concat(e.photos[0].path):"/placeholder.jpg",className:"w-full h-48 object-cover rounded"}),(0,s.jsx)("h2",{className:"text-xl font-bold mt-2",children:e.name}),(0,s.jsx)("p",{children:e.location}),(0,s.jsx)("p",{children:e.description}),(0,s.jsxs)("p",{children:["Rooms: ",e.rooms]}),(0,s.jsxs)("p",{children:["Status: ",null!=(t=e.status)?t:"N/A"]}),e.deleted_on&&(0,s.jsxs)("p",{className:"text-red-600",children:["Deleted On: ",new Date(e.deleted_on).toLocaleDateString()]}),(0,s.jsxs)("div",{className:"mt-2 flex space-x-2",children:[(0,s.jsx)("button",{className:"bg-yellow-500 text-white px-3 py-1 rounded",onClick:()=>{u(e),b([]),m(!0)},children:"Edit"}),(0,s.jsx)("button",{className:"bg-red-600 text-white px-3 py-1 rounded",onClick:()=>j(e.id),children:"Delete"})]})]},e.id)})}),(0,s.jsxs)("div",{className:"mt-6 flex justify-center space-x-4",children:[(0,s.jsx)("button",{onClick:()=>n>1&&c(n-1),disabled:1===n,className:"bg-indigo-600 text-white px-4 py-2 rounded disabled:opacity-50",children:"Previous"}),(0,s.jsxs)("span",{children:["Page ",n," of ",i]}),(0,s.jsx)("button",{onClick:()=>n<i&&c(n+1),disabled:n===i,className:"bg-indigo-600 text-white px-4 py-2 rounded disabled:opacity-50",children:"Next"})]})]}),p&&h&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,s.jsxs)("div",{className:"bg-white p-6 rounded-lg w-full max-w-lg shadow-lg overflow-y-auto max-h-screen text-black",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Edit Apartment"}),(0,s.jsxs)("form",{onSubmit:g,encType:"multipart/form-data",children:[(0,s.jsx)("input",{name:"name",defaultValue:h.name,className:"w-full p-2 mb-2 border"}),(0,s.jsx)("input",{name:"location",defaultValue:h.location,className:"w-full p-2 mb-2 border"}),(0,s.jsx)("textarea",{name:"description",defaultValue:h.description,className:"w-full p-2 mb-2 border"}),(0,s.jsx)("input",{name:"rooms",type:"number",defaultValue:h.rooms,className:"w-full p-2 mb-2 border"}),(0,s.jsxs)("select",{name:"status",defaultValue:null!=(e=h.status)?e:"",className:"w-full p-2 mb-4 border",children:[(0,s.jsx)("option",{value:"",children:"Select status"}),(0,s.jsx)("option",{value:"active",children:"Active"}),(0,s.jsx)("option",{value:"inactive",children:"Inactive"})]}),(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("label",{className:"block font-medium mb-1",children:"Current Photo(s)"}),(0,s.jsx)("div",{className:"flex gap-2 flex-wrap",children:h.photos.map(e=>(0,s.jsxs)("div",{className:"relative group",children:[(0,s.jsx)("img",{src:"".concat(y,"/").concat(e.path),className:"w-24 h-24 object-cover rounded border"}),(0,s.jsx)("button",{type:"button",onClick:()=>w(e.id),className:"absolute top-1 right-1 bg-red-600 text-white text-xs rounded-full px-2 py-1",children:"âœ•"})]},e.id))})]}),(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Upload New Photo(s)"}),(0,s.jsx)("div",{className:"space-y-2",children:x.map((e,t)=>(0,s.jsx)("input",{type:"file",accept:"image/*",name:"photos",onChange:e=>N(t,e),className:"block w-full border rounded p-1"},t))}),(0,s.jsx)("button",{type:"button",onClick:()=>{b([...x,new File([],"")])},className:"mt-2 px-3 py-1 bg-blue-600 text-white rounded",children:"+ Add Another Photo"})]}),(0,s.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,s.jsx)("button",{type:"button",onClick:()=>{m(!1),b([])},className:"bg-gray-500 text-white px-4 py-2 rounded",children:"Cancel"}),(0,s.jsx)("button",{type:"submit",className:"bg-blue-600 text-white px-4 py-2 rounded",children:"Save"})]})]})]})})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[441,684,358],()=>t(4143)),_N_E=e.O()}]);