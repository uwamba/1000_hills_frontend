(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2553],{2335:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>r});var s=a(5155),o=a(2115),l=a(9509);function r(){let[e,t]=(0,o.useState)([]),[a,r]=(0,o.useState)(!0),[c,n]=(0,o.useState)(1),[i,d]=(0,o.useState)(1),[h,m]=(0,o.useState)(!1),[x,u]=(0,o.useState)(null),[p,b]=(0,o.useState)([]),f=localStorage.getItem("authToken"),g=async e=>{try{r(!0);let a=await fetch("".concat("https://backtest.livatrip.com","/hotels?page=").concat(e),{headers:{Authorization:"Bearer ".concat(f)}});if(!a.ok)throw Error("Failed to fetch hotels");let s=await a.json();t(s.data),n(s.current_page),d(s.last_page)}catch(e){console.error("Error fetching hotels:",e)}finally{r(!1)}};(0,o.useEffect)(()=>{f&&g(c)},[c,f]);let j=async e=>{if(e.preventDefault(),!x)return;let t=new FormData(e.currentTarget);t.append("_method","PUT"),p.forEach(e=>{t.append("photos[]",e)});try{if(!(await fetch("".concat("https://backtest.livatrip.com","/hotels/").concat(x.id),{method:"POST",headers:{Authorization:"Bearer ".concat(f)},body:t})).ok)throw Error("Failed to update hotel");m(!1),b([]),g(c)}catch(e){console.error("Error updating hotel:",e)}},w=async e=>{if(confirm("Are you sure you want to delete this hotel?"))try{if(!(await fetch("".concat("https://backtest.livatrip.com","/hotels/").concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(f)}})).ok)throw Error("Failed to delete hotel");g(c)}catch(e){console.error("Error deleting hotel:",e)}},y=async e=>{if(confirm("Are you sure you want to delete this photo?"))try{if(!(await fetch("".concat("https://backtest.livatrip.com","/photos/").concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(f)}})).ok)throw Error("Failed to delete photo");x&&u({...x,photos:x.photos.filter(t=>t.id!==e)})}catch(e){console.error("Error deleting photo:",e)}},N=l.env.NEXT_PUBLIC_IMAGE_BASE_URL_STORAGE||"http://localhost:3000/images",v=async e=>{console.log("Downloading contract for Hotel ID:",e);try{let t=await fetch("".concat("https://backtest.livatrip.com","/download-contract/").concat(e),{method:"GET",headers:{Authorization:"Bearer ".concat(f)}});if(console.log("Response status:",t.status),console.log("Response content-type:",t.headers.get("content-type")),!t.ok){let e=await t.text();console.error("Backend error:",e),alert("Failed to download contract");return}let a=await t.blob();if(!a||0===a.size){console.error("Empty blob received"),alert("Downloaded file is empty");return}let s=window.URL.createObjectURL(a),o=document.createElement("a");o.href=s,o.download="contract_".concat(e,".pdf"),document.body.appendChild(o),o.click(),o.remove(),window.URL.revokeObjectURL(s)}catch(e){console.error("Exception while downloading contract:",e),alert("Error downloading contract")}};return(0,s.jsxs)("div",{className:"p-6 bg-gray-50 min-h-screen text-black",children:[(0,s.jsx)("h1",{className:"text-3xl font-extrabold text-black mb-6",children:"Hotel List"}),a?(0,s.jsx)("div",{className:"text-center text-lg text-gray-800 font-medium",children:"Loading hotels..."}):0===e.length?(0,s.jsx)("div",{className:"text-center text-lg text-gray-800 font-medium",children:"No hotels found."}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:e.map(e=>(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-4 border border-gray-300 hover:shadow-2xl transition-transform transform hover:scale-105",children:[(0,s.jsx)("div",{className:"w-full h-48 mb-4 overflow-hidden rounded-lg",children:(0,s.jsx)("img",{src:e.photos.length>0?"".concat(N,"/").concat(e.photos[0].path):"/placeholder.jpg",alt:e.name,className:"object-cover w-full h-full"})}),(0,s.jsx)("h2",{className:"text-xl font-semibold text-indigo-700",children:e.name}),(0,s.jsx)("p",{className:"text-md text-gray-800",children:e.address}),(0,s.jsx)("p",{className:"text-gray-900 mt-2",children:e.description}),(0,s.jsxs)("p",{className:"text-gray-800 mt-1",children:["Stars: ",e.stars]}),(0,s.jsxs)("div",{className:"mt-2 text-sm text-gray-900 space-y-1",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"font-medium",children:"Status:"})," ",(0,s.jsx)("span",{className:"active"===e.status?"text-green-700 font-semibold":"text-red-700 font-semibold",children:e.status||"N/A"})]}),e.deleted_on&&(0,s.jsxs)("div",{className:"text-red-600 font-medium",children:[(0,s.jsx)("span",{className:"font-medium",children:"Deleted On:"})," ",new Date(e.deleted_on).toLocaleDateString()]})]}),(0,s.jsxs)("div",{className:"mt-4 flex space-x-2",children:[(0,s.jsx)("button",{onClick:()=>{u(e),b([]),m(!0)},className:"px-3 py-1 bg-yellow-500 text-white rounded",children:"Edit"}),(0,s.jsx)("button",{onClick:()=>w(e.id),className:"px-3 py-1 bg-red-600 text-white rounded",children:"Delete"}),(0,s.jsx)("button",{className:"bg-purple-500 text-white px-2 py-1 rounded hover:bg-purple-600",onClick:()=>v(e.id),children:"Contract"})]})]},e.id))}),(0,s.jsxs)("div",{className:"mt-8 flex justify-center space-x-4",children:[(0,s.jsx)("button",{onClick:()=>c>1&&n(c-1),disabled:1===c,className:"px-4 py-2 bg-indigo-600 text-white rounded disabled:opacity-50",children:"Previous"}),(0,s.jsxs)("span",{className:"px-4 py-2 text-black font-semibold",children:["Page ",c," of ",i]}),(0,s.jsx)("button",{onClick:()=>c<i&&n(c+1),disabled:c===i,className:"px-4 py-2 bg-indigo-600 text-white rounded disabled:opacity-50",children:"Next"})]})]}),h&&x&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,s.jsxs)("div",{className:"bg-white p-6 rounded-lg w-full max-w-lg shadow-lg overflow-y-auto max-h-screen text-black",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Edit Hotel"}),(0,s.jsxs)("form",{onSubmit:j,encType:"multipart/form-data",children:[(0,s.jsx)("input",{name:"name",defaultValue:x.name,className:"w-full p-2 mb-2 border text-black"}),(0,s.jsx)("input",{name:"address",defaultValue:x.address,className:"w-full p-2 mb-2 border text-black"}),(0,s.jsx)("textarea",{name:"description",defaultValue:x.description,className:"w-full p-2 mb-2 border text-black"}),(0,s.jsx)("input",{name:"stars",type:"number",defaultValue:x.stars,className:"w-full p-2 mb-2 border text-black"}),(0,s.jsxs)("select",{name:"status",defaultValue:x.status||"",className:"w-full p-2 mb-4 border text-black",children:[(0,s.jsx)("option",{value:"",children:"Select status"}),(0,s.jsx)("option",{value:"active",children:"Active"}),(0,s.jsx)("option",{value:"inactive",children:"Inactive"})]}),(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-1 text-black",children:"Current Photo(s)"}),(0,s.jsx)("div",{className:"flex gap-2 flex-wrap",children:x.photos.map(e=>(0,s.jsxs)("div",{className:"relative group",children:[(0,s.jsx)("img",{src:"".concat(N,"/").concat(e.path),className:"w-24 h-24 object-cover rounded border"}),(0,s.jsx)("button",{type:"button",onClick:()=>y(e.id),className:"absolute top-1 right-1 bg-red-600 text-white text-xs rounded-full px-2 py-1",children:"âœ•"})]},e.id))})]}),(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2 text-black",children:"Upload New Photo(s)"}),(0,s.jsx)("div",{className:"space-y-2",children:p.map((e,t)=>(0,s.jsx)("input",{type:"file",accept:"image/*",name:"photos",onChange:e=>((e,t)=>{let a=t.target.files;if(!a)return;let s=[...p];s[e]=a[0],b(s)})(t,e),className:"block w-full text-sm text-gray-700 file:mr-4 file:py-2 file:px-4   file:rounded file:border-0 file:text-sm file:font-semibold   file:bg-blue-50 file:text-blue-700   hover:file:bg-blue-100 border border-gray-300 rounded"},t))}),(0,s.jsx)("button",{type:"button",onClick:()=>{b([...p,new File([],"")])},className:"mt-3 inline-flex items-center px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded hover:bg-blue-700 transition",children:"+ Add Another Photo"})]}),(0,s.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,s.jsx)("button",{type:"button",onClick:()=>{m(!1),b([])},className:"px-4 py-2 bg-gray-500 text-white rounded",children:"Cancel"}),(0,s.jsx)("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded",children:"Save"})]})]})]})})]})}},2397:(e,t,a)=>{Promise.resolve().then(a.bind(a,2335))}},e=>{e.O(0,[8441,5964,7358],()=>e(e.s=2397)),_N_E=e.O()}]);