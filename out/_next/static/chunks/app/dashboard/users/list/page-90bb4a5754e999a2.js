(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6939],{239:(e,t,a)=>{Promise.resolve().then(a.bind(a,8481))},8481:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>l});var s=a(5155),r=a(2115);function l(){let[e,t]=(0,r.useState)([]),[a,l]=(0,r.useState)(!0),[o,c]=(0,r.useState)(null),[n,d]=(0,r.useState)(!1),[i,u]=(0,r.useState)(null),[h,p]=(0,r.useState)(null),[m,x]=(0,r.useState)(""),[b,g]=(0,r.useState)("");(0,r.useEffect)(()=>{f()},[]);let f=async()=>{try{l(!0),u(null);let e=localStorage.getItem("authToken"),a=await fetch("".concat("https://stage-front.livatrip.com","/admin"),{headers:{Authorization:"Bearer ".concat(e)}});if(!a.ok)throw Error("Failed to fetch users.");let s=await a.json();if(Array.isArray(s))t(s);else if(s&&Array.isArray(s.data))t(s.data);else throw Error("Unexpected response format.")}catch(e){console.error("Error fetching users:",e),u(e.message||"Something went wrong while fetching users.")}finally{l(!1)}},w=async e=>{if(confirm("Are you sure you want to delete this user?"))try{let t=localStorage.getItem("authToken");(await fetch("".concat("https://stage-front.livatrip.com","/admin/").concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(t)}})).ok?(alert("User deleted successfully!"),f()):alert("Failed to delete user.")}catch(e){console.error("Error deleting user:",e)}},j=async(e,t)=>{try{let a=localStorage.getItem("authToken"),s=t?"".concat("https://stage-front.livatrip.com","/admin/").concat(e,"/deactivate"):"".concat("https://stage-front.livatrip.com","/admin/").concat(e,"/activate"),r=await fetch(s,{method:"POST",headers:{Authorization:"Bearer ".concat(a),"Content-Type":"application/json"}});if(r.ok)alert("User ".concat(t?"deactivated":"activated"," successfully!")),f();else{let e=await r.text();alert("Failed to toggle user status: ".concat(e))}}catch(e){console.error("Error toggling user status:",e),alert(e.message||"An error occurred while changing status.")}},y=async()=>{if(h){if(!m||!b)return void alert("Please enter and confirm the new password.");if(m!==b)return void alert("Passwords do not match.");try{let e=localStorage.getItem("authToken"),t=await fetch("".concat("https://stage-front.livatrip.com","/admin/").concat(h.id,"/reset-password"),{method:"PUT",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify({password:m,password_confirmation:b})});if(t.ok)alert("Password updated successfully!"),p(null);else{let e=await t.json();alert("Failed to update password: ".concat(e.message||JSON.stringify(e)))}}catch(e){console.error("Error updating password:",e),alert("An error occurred while updating the password.")}}},N=async()=>{if(o)try{let e=localStorage.getItem("authToken");(await fetch("".concat("https://stage-front.livatrip.com","/admin/").concat(o.id),{method:"PUT",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify(o)})).ok?(alert("User updated successfully!"),d(!1),f()):alert("Failed to update user.")}catch(e){console.error("Error updating user:",e)}};return(0,s.jsxs)("div",{className:"max-w-5xl mx-auto p-4 bg-white shadow rounded",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold mb-4 text-black",children:"User List"}),i&&(0,s.jsx)("div",{className:"mb-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded",children:i}),a?(0,s.jsx)("p",{children:"Loading users..."}):0===e.length?(0,s.jsx)("p",{children:"No users found."}):(0,s.jsxs)("table",{className:"min-w-full border border-gray-300 text-gray-800",children:[(0,s.jsx)("thead",{className:"bg-gray-100 text-gray-800 font-semibold",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"p-2 border",children:"Names"}),(0,s.jsx)("th",{className:"p-2 border",children:"Email"}),(0,s.jsx)("th",{className:"p-2 border",children:"Role"}),(0,s.jsx)("th",{className:"p-2 border",children:"Object"}),(0,s.jsx)("th",{className:"p-2 border",children:"Status"}),(0,s.jsx)("th",{className:"p-2 border",children:"Actions"})]})}),(0,s.jsx)("tbody",{children:e.map(e=>(0,s.jsxs)("tr",{className:"".concat(e.is_active?"bg-white":"bg-red-100 font-medium"),children:[(0,s.jsx)("td",{className:"p-2 border",children:e.names}),(0,s.jsx)("td",{className:"p-2 border",children:e.email}),(0,s.jsx)("td",{className:"p-2 border",children:e.role}),(0,s.jsxs)("td",{className:"p-2 border",children:[e.object," (ID: ",e.object_id,")"]}),(0,s.jsx)("td",{className:"p-2 border",children:e.is_active?"Active":"Inactive"}),(0,s.jsxs)("td",{className:"p-2 border space-x-1 flex flex-wrap",children:[(0,s.jsx)("button",{onClick:()=>{c(e),d(!0)},className:"bg-blue-500 text-white px-2 py-1 rounded",children:"Edit"}),(0,s.jsx)("button",{onClick:()=>w(e.id),className:"bg-red-500 text-white px-2 py-1 rounded",children:"Delete"}),(0,s.jsx)("button",{onClick:()=>j(e.id,e.is_active),className:"".concat(e.is_active?"bg-yellow-500":"bg-green-500"," text-white px-2 py-1 rounded"),children:e.is_active?"Deactivate":"Activate"}),(0,s.jsx)("button",{onClick:()=>{p(e),x(""),g("")},className:"bg-purple-500 text-white px-2 py-1 rounded",children:"Set Password"})]})]},e.id))})]}),n&&o&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,s.jsxs)("div",{className:"bg-white p-6 rounded-lg w-full max-w-lg shadow-xl",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-4 text-black",children:"Edit User"}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)("input",{className:"w-full border p-2 rounded text-black",value:o.names,onChange:e=>c({...o,names:e.target.value}),placeholder:"Name"}),(0,s.jsx)("input",{className:"w-full border p-2 rounded text-black",value:o.email,onChange:e=>c({...o,email:e.target.value}),placeholder:"Email"}),(0,s.jsx)("input",{className:"w-full border p-2 rounded text-black",value:o.phone,onChange:e=>c({...o,phone:e.target.value}),placeholder:"Phone"}),(0,s.jsx)("input",{className:"w-full border p-2 rounded text-black",value:o.address,onChange:e=>c({...o,address:e.target.value}),placeholder:"Address"}),(0,s.jsx)("input",{className:"w-full border p-2 rounded text-black",value:o.role,onChange:e=>c({...o,role:e.target.value}),placeholder:"Role"})]}),(0,s.jsxs)("div",{className:"flex justify-end mt-4 space-x-2",children:[(0,s.jsx)("button",{className:"bg-gray-400 text-white px-4 py-2 rounded",onClick:()=>d(!1),children:"Cancel"}),(0,s.jsx)("button",{className:"bg-blue-600 text-white px-4 py-2 rounded",onClick:N,children:"Save"})]})]})}),h&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,s.jsxs)("div",{className:"bg-white p-6 rounded-lg w-full max-w-sm shadow-xl",children:[(0,s.jsxs)("h2",{className:"text-xl font-semibold mb-4 text-black",children:["Set Password for ",h.names]}),(0,s.jsx)("input",{type:"password",className:"w-full border p-2 rounded text-black mb-2",placeholder:"Enter new password",value:m,onChange:e=>x(e.target.value),autoComplete:"new-password"}),(0,s.jsx)("input",{type:"password",className:"w-full border p-2 rounded text-black mb-4",placeholder:"Confirm new password",value:b,onChange:e=>g(e.target.value),autoComplete:"new-password"}),(0,s.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,s.jsx)("button",{className:"bg-gray-400 hover:bg-gray-500 text-white px-4 py-2 rounded",onClick:()=>p(null),children:"Cancel"}),(0,s.jsx)("button",{className:"bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded",onClick:y,children:"Update Password"})]})]})})]})}}},e=>{e.O(0,[8441,5964,7358],()=>e(e.s=239)),_N_E=e.O()}]);