(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6939],{3448:(e,t,a)=>{Promise.resolve().then(a.bind(a,8481))},8481:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>l});var r=a(5155),s=a(2115);function l(){let[e,t]=(0,s.useState)([]),[a,l]=(0,s.useState)(!0),[o,c]=(0,s.useState)(null),[n,i]=(0,s.useState)(!1);(0,s.useEffect)(()=>{d()},[]);let d=async()=>{try{l(!0);let e=localStorage.getItem("authToken"),a=await fetch("".concat("https://staging.livatrip.com/api","/admin"),{headers:{Authorization:"Bearer ".concat(e)}});if(!a.ok)return void console.error("Failed to fetch users");let r=await a.json();Array.isArray(r)?t(r):r&&Array.isArray(r.data)?t(r.data):(console.error("Unexpected response format:",r),t([]))}catch(e){console.error("Error:",e)}finally{l(!1)}},h=async e=>{if(confirm("Are you sure you want to delete this user?"))try{let t=localStorage.getItem("authToken");(await fetch("".concat("https://staging.livatrip.com/api","/admin/").concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(t)}})).ok?(alert("User deleted successfully!"),d()):alert("Failed to delete user.")}catch(e){console.error("Error deleting user:",e)}},u=async(e,t)=>{try{let a=localStorage.getItem("authToken");(await fetch("".concat("https://staging.livatrip.com/api","/admin/").concat(e,"/status"),{method:"PATCH",headers:{Authorization:"Bearer ".concat(a),"Content-Type":"application/json"},body:JSON.stringify({is_active:!t})})).ok?(alert("User ".concat(t?"deactivated":"activated"," successfully!")),d()):alert("Failed to toggle user status.")}catch(e){console.error("Error toggling user status:",e)}},p=async e=>{let t=prompt("Enter new password:");if(t)try{let a=localStorage.getItem("authToken");(await fetch("".concat("https://staging.livatrip.com/api","/admin/").concat(e,"/password"),{method:"PATCH",headers:{Authorization:"Bearer ".concat(a),"Content-Type":"application/json"},body:JSON.stringify({password:t})})).ok?alert("Password updated successfully!"):alert("Failed to update password.")}catch(e){console.error("Error updating password:",e)}},x=e=>{c(e),i(!0)},m=async()=>{if(o)try{let e=localStorage.getItem("authToken");(await fetch("".concat("https://staging.livatrip.com/api","/admin/").concat(o.id),{method:"PUT",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify(o)})).ok?(alert("User updated successfully!"),i(!1),d()):alert("Failed to update user.")}catch(e){console.error("Error updating user:",e)}};return(0,r.jsxs)("div",{className:"max-w-5xl mx-auto p-4 bg-white shadow rounded",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold mb-4 text-black",children:"User List"}),a?(0,r.jsx)("p",{children:"Loading users..."}):0===e.length?(0,r.jsx)("p",{children:"No users found."}):(0,r.jsxs)("table",{className:"min-w-full border border-gray-300 text-gray-800",children:[(0,r.jsx)("thead",{className:"bg-gray-100 text-gray-800 font-semibold",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"p-2 border",children:"Names"}),(0,r.jsx)("th",{className:"p-2 border",children:"Email"}),(0,r.jsx)("th",{className:"p-2 border",children:"Role"}),(0,r.jsx)("th",{className:"p-2 border",children:"Object"}),(0,r.jsx)("th",{className:"p-2 border",children:"Status"}),(0,r.jsx)("th",{className:"p-2 border",children:"Actions"})]})}),(0,r.jsx)("tbody",{children:e.map(e=>(0,r.jsxs)("tr",{className:"".concat(e.is_active?"bg-white text-gray-800":"bg-red-100 text-gray-900 font-medium"),children:[(0,r.jsx)("td",{className:"p-2 border",children:e.names}),(0,r.jsx)("td",{className:"p-2 border",children:e.email}),(0,r.jsx)("td",{className:"p-2 border",children:e.role}),(0,r.jsxs)("td",{className:"p-2 border",children:[e.object," (ID: ",e.object_id,")"]}),(0,r.jsx)("td",{className:"p-2 border",children:e.is_active?"Active":"Inactive"}),(0,r.jsxs)("td",{className:"p-2 border space-x-1 flex flex-wrap",children:[(0,r.jsx)("button",{onClick:()=>x(e),className:"bg-blue-500 hover:bg-blue-600 text-white px-2 py-1 rounded",children:"Edit"}),(0,r.jsx)("button",{onClick:()=>h(e.id),className:"bg-red-500 hover:bg-red-600 text-white px-2 py-1 rounded",children:"Delete"}),(0,r.jsx)("button",{onClick:()=>u(e.id,e.is_active),className:"".concat(e.is_active?"bg-yellow-500 hover:bg-yellow-600":"bg-green-500 hover:bg-green-600"," text-white px-2 py-1 rounded"),children:e.is_active?"Deactivate":"Activate"}),(0,r.jsx)("button",{onClick:()=>p(e.id),className:"bg-purple-500 hover:bg-purple-600 text-white px-2 py-1 rounded",children:"Set Password"})]})]},e.id))})]}),n&&o&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg w-full max-w-lg shadow-xl",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold mb-4 text-black",children:"Edit User"}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsx)("input",{className:"w-full border p-2 rounded text-black",type:"text",value:o.names,onChange:e=>c({...o,names:e.target.value}),placeholder:"Name"}),(0,r.jsx)("input",{className:"w-full border p-2 rounded text-black",type:"email",value:o.email,onChange:e=>c({...o,email:e.target.value}),placeholder:"Email"}),(0,r.jsx)("input",{className:"w-full border p-2 rounded text-black",type:"text",value:o.phone,onChange:e=>c({...o,phone:e.target.value}),placeholder:"Phone"}),(0,r.jsx)("input",{className:"w-full border p-2 rounded text-black",type:"text",value:o.address,onChange:e=>c({...o,address:e.target.value}),placeholder:"Address"}),(0,r.jsx)("input",{className:"w-full border p-2 rounded text-black",type:"text",value:o.role,onChange:e=>c({...o,role:e.target.value}),placeholder:"Role"})]}),(0,r.jsxs)("div",{className:"flex justify-end mt-6 space-x-2",children:[(0,r.jsx)("button",{className:"bg-gray-400 hover:bg-gray-500 text-white px-4 py-2 rounded",onClick:()=>i(!1),children:"Cancel"}),(0,r.jsx)("button",{className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded",onClick:m,children:"Save Changes"})]})]})})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[8441,1684,7358],()=>t(3448)),_N_E=e.O()}]);