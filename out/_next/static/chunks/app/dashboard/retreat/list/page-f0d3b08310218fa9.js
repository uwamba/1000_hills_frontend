(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4278],{55:(e,t,a)=>{Promise.resolve().then(a.bind(a,6576))},6576:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>r});var s=a(5155),l=a(2115);function r(){let[e,t]=(0,l.useState)([]),[a,r]=(0,l.useState)(!0),[i,o]=(0,l.useState)(1),[c,d]=(0,l.useState)(1),[n,h]=(0,l.useState)(!1),[m,p]=(0,l.useState)(null),[x,u]=(0,l.useState)(!1),[g,b]=(0,l.useState)(null),[f,j]=(0,l.useState)([]),N="https://staging.livatrip.com/storage",y=async e=>{try{r(!0);let a=localStorage.getItem("authToken"),s=await fetch("".concat("https://staging.livatrip.com/api","/retreats?page=").concat(e),{headers:{Authorization:"Bearer ".concat(a),Accept:"application/json"}});if(!s.ok)throw Error("Failed to fetch retreats");let l=await s.json();t(l.data),o(l.current_page),d(l.last_page)}catch(e){console.error("Error fetching retreats:",e)}finally{r(!1)}};(0,l.useEffect)(()=>{y(i)},[i]);let v=e=>{p(e),j([]),h(!0)},w=e=>{b(e),u(!0)},k=async()=>{if(g)try{let e=localStorage.getItem("authToken");if(!(await fetch("".concat("https://staging.livatrip.com/api","/retreats/").concat(g),{method:"DELETE",headers:{Authorization:"Bearer ".concat(e)}})).ok)throw Error("Failed to delete retreat");u(!1),y(i)}catch(e){console.error("Error deleting retreat:",e)}},C=async()=>{if(m)try{let e=localStorage.getItem("authToken"),t=new FormData;if(t.append("title",m.title),t.append("description",m.description),t.append("address",m.address),t.append("capacity",String(m.capacity)),f.forEach(e=>{t.append("photos[]",e)}),!(await fetch("".concat("https://staging.livatrip.com/api","/retreats/").concat(m.id),{method:"POST",headers:{Authorization:"Bearer ".concat(e)},body:t})).ok)throw Error("Failed to update retreat");h(!1),y(i)}catch(e){console.error("Error updating retreat:",e)}},E=e=>{m&&p({...m,[e.target.name]:e.target.value})},S=(e,t)=>{var a;let s=null==(a=t.target.files)?void 0:a[0];if(s){let t=[...f];t[e]=s,j(t)}},A=async e=>{if(m)try{let t=localStorage.getItem("authToken");if(!(await fetch("".concat("https://staging.livatrip.com/api","/retreat-photos/").concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(t)}})).ok)throw Error("Failed to delete photo");let a=m.photos.filter(t=>t.id!==e);p({...m,photos:a})}catch(e){console.error("Error deleting photo:",e)}};return(0,s.jsxs)("div",{className:"p-6 bg-gray-50 min-h-screen text-black",children:[(0,s.jsx)("h1",{className:"text-3xl font-extrabold mb-6",children:"Retreat List"}),a?(0,s.jsx)("div",{className:"text-center text-lg font-medium",children:"Loading retreats..."}):0===e.length?(0,s.jsx)("div",{className:"text-center text-lg font-medium",children:"No retreats found."}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:e.map(e=>(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-4 border border-gray-300 hover:shadow-2xl transition-transform transform hover:scale-105",children:[(0,s.jsx)("div",{className:"w-full h-48 mb-4 overflow-hidden rounded-lg",children:(0,s.jsx)("img",{src:e.photos.length>0?"".concat(N,"/").concat(e.photos[0].path):"/placeholder.jpg",alt:e.title,className:"object-cover w-full h-full"})}),(0,s.jsx)("h2",{className:"text-xl font-semibold text-indigo-700",children:e.title}),(0,s.jsxs)("p",{className:"text-md text-gray-800",children:["Address: ",e.address]}),(0,s.jsxs)("p",{className:"text-md text-gray-800",children:["Capacity: ",e.capacity]}),(0,s.jsx)("p",{className:"text-gray-900 mt-2",children:e.description}),(0,s.jsxs)("div",{className:"mt-2 text-sm space-y-1",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"font-medium",children:"Status:"})," ",(0,s.jsx)("span",{className:"available"===e.status?"text-green-700 font-semibold":"text-red-700 font-semibold",children:e.status||"N/A"})]}),(0,s.jsxs)("div",{className:"font-medium",children:["Viewed: ",e.viewed]}),e.deleted_on&&(0,s.jsxs)("div",{className:"text-red-600 font-medium",children:["Deleted On: ",new Date(e.deleted_on).toLocaleDateString()]})]}),(0,s.jsxs)("div",{className:"mt-4 flex space-x-2",children:[(0,s.jsx)("button",{onClick:()=>v(e),className:"px-3 py-1 bg-yellow-500 text-white rounded",children:"Edit"}),(0,s.jsx)("button",{onClick:()=>w(e.id),className:"px-3 py-1 bg-red-600 text-white rounded",children:"Delete"})]})]},e.id))}),(0,s.jsxs)("div",{className:"mt-8 flex justify-center space-x-4",children:[(0,s.jsx)("button",{onClick:()=>i>1&&o(i-1),disabled:1===i,className:"px-4 py-2 bg-indigo-600 text-white rounded disabled:opacity-50",children:"Previous"}),(0,s.jsxs)("span",{className:"px-4 py-2 font-semibold",children:["Page ",i," of ",c]}),(0,s.jsx)("button",{onClick:()=>i<c&&o(i+1),disabled:i===c,className:"px-4 py-2 bg-indigo-600 text-white rounded disabled:opacity-50",children:"Next"})]})]}),n&&m&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6 w-full max-w-md overflow-y-auto max-h-screen",children:[(0,s.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Edit Retreat"}),(0,s.jsx)("input",{type:"text",name:"title",value:m.title,onChange:E,placeholder:"Title",className:"w-full p-2 border rounded mb-2"}),(0,s.jsx)("textarea",{name:"description",value:m.description,onChange:E,placeholder:"Description",className:"w-full p-2 border rounded mb-2"}),(0,s.jsx)("input",{type:"text",name:"address",value:m.address,onChange:E,placeholder:"Address",className:"w-full p-2 border rounded mb-2"}),(0,s.jsx)("input",{type:"number",name:"capacity",value:m.capacity,onChange:E,placeholder:"Capacity",className:"w-full p-2 border rounded mb-2"}),(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Current Photo(s)"}),(0,s.jsx)("div",{className:"flex gap-2 flex-wrap",children:m.photos.map(e=>(0,s.jsxs)("div",{className:"relative group",children:[(0,s.jsx)("img",{src:"".concat(N,"/").concat(e.path),className:"w-24 h-24 object-cover rounded border"}),(0,s.jsx)("button",{type:"button",onClick:()=>A(e.id),className:"absolute top-1 right-1 bg-red-600 text-white text-xs rounded-full px-2 py-1",children:"âœ•"})]},e.id))})]}),(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Upload New Photo(s)"}),(0,s.jsx)("div",{className:"space-y-2",children:f.map((e,t)=>(0,s.jsx)("input",{type:"file",accept:"image/*",name:"photos",onChange:e=>S(t,e),className:"block w-full text-sm file:mr-4 file:py-2 file:px-4 file:rounded file:border-0 file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100 border border-gray-300 rounded"},t))}),(0,s.jsx)("button",{type:"button",onClick:()=>{j([...f,new File([],"")])},className:"mt-3 inline-flex items-center px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded hover:bg-blue-700 transition",children:"+ Add Another Photo"})]}),(0,s.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,s.jsx)("button",{onClick:()=>h(!1),className:"px-4 py-2 bg-gray-500 text-white rounded",children:"Cancel"}),(0,s.jsx)("button",{onClick:C,className:"px-4 py-2 bg-blue-600 text-white rounded",children:"Save"})]})]})}),x&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,s.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-lg w-full max-w-sm",children:[(0,s.jsx)("h2",{className:"text-lg font-bold mb-4",children:"Confirm Deletion"}),(0,s.jsx)("p",{className:"mb-4",children:"Are you sure you want to delete this retreat?"}),(0,s.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,s.jsx)("button",{onClick:()=>u(!1),className:"px-4 py-2 bg-gray-500 text-white rounded",children:"Cancel"}),(0,s.jsx)("button",{onClick:k,className:"px-4 py-2 bg-red-600 text-white rounded",children:"Delete"})]})]})})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[8441,1684,7358],()=>t(55)),_N_E=e.O()}]);