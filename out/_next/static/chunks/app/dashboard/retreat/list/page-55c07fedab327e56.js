(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[278],{2914:(e,t,a)=>{Promise.resolve().then(a.bind(a,6576))},6576:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>l});var s=a(5155),r=a(2115);function l(){var e;let[t,a]=(0,r.useState)([]),[l,i]=(0,r.useState)(!0),[c,o]=(0,r.useState)(1),[n,d]=(0,r.useState)(1),[p,h]=(0,r.useState)(!1),[u,m]=(0,r.useState)(null),[x,b]=(0,r.useState)([]),f="https://staging.livatrip.com/storage",g=async e=>{try{i(!0);let t=await fetch("".concat("https://staging.livatrip.com/api","/retreats?page=").concat(e));if(!t.ok)throw Error("Failed to fetch retreats");let s=await t.json();a(s.data),o(s.current_page),d(s.last_page)}catch(e){console.error("Error fetching retreats:",e)}finally{i(!1)}};(0,r.useEffect)(()=>{g(c)},[c]);let j=async e=>{if(e.preventDefault(),!u)return;let t=new FormData(e.currentTarget);t.append("_method","PUT"),x.forEach(e=>{t.append("photos[]",e)});try{if(!(await fetch("".concat("https://staging.livatrip.com/api","/retreats/").concat(u.id),{method:"POST",body:t})).ok)throw Error("Failed to update retreat");h(!1),b([]),g(c)}catch(e){console.error("Error updating retreat:",e)}},w=async e=>{if(confirm("Are you sure you want to delete this retreat?"))try{if(!(await fetch("".concat("https://staging.livatrip.com/api","/retreats/").concat(e),{method:"DELETE"})).ok)throw Error("Failed to delete retreat");g(c)}catch(e){console.error("Error deleting retreat:",e)}},y=async e=>{if(confirm("Are you sure you want to delete this photo?"))try{if(!(await fetch("".concat("https://staging.livatrip.com/api","/photos/").concat(e),{method:"DELETE"})).ok)throw Error("Failed to delete photo");u&&m({...u,photos:u.photos.filter(t=>t.id!==e)})}catch(e){console.error("Error deleting photo:",e)}},N=(e,t)=>{let a=t.target.files;if(!a)return;let s=[...x];s[e]=a[0],b(s)};return(0,s.jsxs)("div",{className:"p-6 bg-gray-50 min-h-screen text-black",children:[(0,s.jsx)("h1",{className:"text-3xl font-extrabold text-black mb-6",children:"Retreat List"}),l?(0,s.jsx)("div",{children:"Loading retreats..."}):0===t.length?(0,s.jsx)("div",{children:"No retreats found."}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map(e=>{var t;return(0,s.jsxs)("div",{className:"bg-white p-4 rounded shadow",children:[(0,s.jsx)("img",{src:e.photos[0]?"".concat(f,"/").concat(e.photos[0].path):"/placeholder.jpg",className:"w-full h-48 object-cover rounded"}),(0,s.jsx)("h2",{className:"text-xl font-bold mt-2",children:e.title}),(0,s.jsx)("p",{children:e.address}),(0,s.jsx)("p",{children:e.description}),(0,s.jsxs)("p",{children:["Capacity: ",e.capacity]}),(0,s.jsxs)("p",{children:["Status: ",null!=(t=e.status)?t:"N/A"]}),(0,s.jsxs)("p",{children:["Viewed: ",e.viewed]}),e.deleted_on&&(0,s.jsxs)("p",{className:"text-red-600",children:["Deleted On: ",new Date(e.deleted_on).toLocaleDateString()]}),(0,s.jsxs)("div",{className:"mt-2 flex space-x-2",children:[(0,s.jsx)("button",{className:"bg-yellow-500 text-white px-3 py-1 rounded",onClick:()=>{m(e),b([]),h(!0)},children:"Edit"}),(0,s.jsx)("button",{className:"bg-red-600 text-white px-3 py-1 rounded",onClick:()=>w(e.id),children:"Delete"})]})]},e.id)})}),(0,s.jsxs)("div",{className:"mt-6 flex justify-center space-x-4",children:[(0,s.jsx)("button",{onClick:()=>c>1&&o(c-1),disabled:1===c,className:"bg-indigo-600 text-white px-4 py-2 rounded disabled:opacity-50",children:"Previous"}),(0,s.jsxs)("span",{children:["Page ",c," of ",n]}),(0,s.jsx)("button",{onClick:()=>c<n&&o(c+1),disabled:c===n,className:"bg-indigo-600 text-white px-4 py-2 rounded disabled:opacity-50",children:"Next"})]})]}),p&&u&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,s.jsxs)("div",{className:"bg-white p-6 rounded-lg w-full max-w-lg shadow-lg overflow-y-auto max-h-screen text-black",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Edit Retreat"}),(0,s.jsxs)("form",{onSubmit:j,encType:"multipart/form-data",children:[(0,s.jsx)("input",{name:"title",defaultValue:u.title,className:"w-full p-2 mb-2 border"}),(0,s.jsx)("input",{name:"address",defaultValue:u.address,className:"w-full p-2 mb-2 border"}),(0,s.jsx)("textarea",{name:"description",defaultValue:u.description,className:"w-full p-2 mb-2 border"}),(0,s.jsx)("input",{name:"capacity",type:"number",defaultValue:u.capacity,className:"w-full p-2 mb-2 border"}),(0,s.jsxs)("select",{name:"status",defaultValue:null!=(e=u.status)?e:"",className:"w-full p-2 mb-4 border",children:[(0,s.jsx)("option",{value:"",children:"Select status"}),(0,s.jsx)("option",{value:"active",children:"Active"}),(0,s.jsx)("option",{value:"inactive",children:"Inactive"})]}),(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("label",{className:"block font-medium mb-1",children:"Current Photo(s)"}),(0,s.jsx)("div",{className:"flex gap-2 flex-wrap",children:u.photos.map(e=>(0,s.jsxs)("div",{className:"relative group",children:[(0,s.jsx)("img",{src:"".concat(f,"/").concat(e.path),className:"w-24 h-24 object-cover rounded border"}),(0,s.jsx)("button",{type:"button",onClick:()=>y(e.id),className:"absolute top-1 right-1 bg-red-600 text-white text-xs rounded-full px-2 py-1",children:"âœ•"})]},e.id))})]}),(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Upload New Photo(s)"}),(0,s.jsx)("div",{className:"space-y-2",children:x.map((e,t)=>(0,s.jsx)("input",{type:"file",accept:"image/*",name:"photos",onChange:e=>N(t,e),className:"block w-full border rounded p-1"},t))}),(0,s.jsx)("button",{type:"button",onClick:()=>{b([...x,new File([],"")])},className:"mt-2 px-3 py-1 bg-blue-600 text-white rounded",children:"+ Add Another Photo"})]}),(0,s.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,s.jsx)("button",{type:"button",onClick:()=>{h(!1),b([])},className:"bg-gray-500 text-white px-4 py-2 rounded",children:"Cancel"}),(0,s.jsx)("button",{type:"submit",className:"bg-blue-600 text-white px-4 py-2 rounded",children:"Save"})]})]})]})})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[441,684,358],()=>t(2914)),_N_E=e.O()}]);