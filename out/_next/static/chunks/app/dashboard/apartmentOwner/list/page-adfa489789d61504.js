(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9568],{2611:(e,t,a)=>{Promise.resolve().then(a.bind(a,7522))},7522:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>l});var s=a(5155),r=a(2115),n=a(9509);function l(){let[e,t]=(0,r.useState)([]),[a,l]=(0,r.useState)(!0),[c,o]=(0,r.useState)(1),[d,i]=(0,r.useState)(1),[m,u]=(0,r.useState)(!1),[x,h]=(0,r.useState)(null),[p,b]=(0,r.useState)(null),f=localStorage.getItem("authToken"),g="https://staging.livatrip.com/api",w=async e=>{if(!f)return void console.warn("No auth token found");l(!0);try{let a=await fetch("".concat(g,"/apartment-owners?page=").concat(e),{headers:{Authorization:"Bearer ".concat(f)}});if(!a.ok)throw Error("Failed to fetch owners (".concat(a.status,")"));let s=await a.json();t(s.data),o(s.current_page),i(s.last_page)}catch(e){console.error("Error fetching apartment owners:",e)}finally{l(!1)}};(0,r.useEffect)(()=>{f&&w(c)},[c,f]);let N=async e=>{if(e.preventDefault(),!x)return;if(!f)return void console.warn("No auth token");let t=new FormData,a=e.currentTarget,s=a.querySelector('input[name="name"]'),r=a.querySelector('input[name="address"]'),n=a.querySelector('select[name="status"]');s&&t.append("name",s.value),r&&t.append("address",r.value),n&&t.append("status",n.value),p&&t.append("contract",p),t.append("_method","PUT");try{let e=await fetch("".concat(g,"/apartment-owners/").concat(x.id),{method:"POST",headers:{Authorization:"Bearer ".concat(f)},body:t});if(!e.ok)throw Error("Failed to update owner (".concat(e.status,")"));u(!1),b(null),w(c)}catch(e){console.error("Error updating apartment owner:",e)}},j=async e=>{if(f&&confirm("Are you sure you want to delete this apartment owner?"))try{let t=await fetch("".concat(g,"/apartment-owners/").concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(f)}});if(!t.ok)throw Error("Failed to delete (status ".concat(t.status,")"));w(c)}catch(e){console.error("Error deleting apartment owner:",e)}},y=n.env.NEXT_PUBLIC_FILE_BASE_URL_STORAGE||"https://staging.livatrip.com/api";return(0,s.jsxs)("div",{className:"p-6 bg-gray-50 min-h-screen text-black",children:[(0,s.jsx)("h1",{className:"text-3xl font-extrabold text-black mb-6",children:"Apartment Owners"}),a?(0,s.jsx)("div",{className:"text-center text-lg text-gray-800 font-medium",children:"Loading apartment owners..."}):0===e.length?(0,s.jsx)("div",{className:"text-center text-lg text-gray-800 font-medium",children:"No apartment owners found."}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:e.map(e=>(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-4 border border-gray-300 hover:shadow-2xl transition-transform transform hover:scale-105",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold text-indigo-700",children:e.name}),(0,s.jsx)("p",{className:"text-md text-gray-800",children:e.address}),(0,s.jsxs)("div",{className:"mt-2 text-sm text-gray-900 space-y-1",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"font-medium",children:"Status:"})," ",(0,s.jsx)("span",{className:"active"===e.status?"text-green-700 font-semibold":"text-red-700 font-semibold",children:e.status||"N/A"})]}),e.contract_path&&(0,s.jsxs)("div",{className:"text-blue-700",children:[(0,s.jsx)("span",{className:"font-medium",children:"Contract:"})," ",(0,s.jsx)("a",{href:"".concat(y,"/").concat(e.contract_path),target:"_blank",rel:"noopener noreferrer",className:"underline",children:"View / Download"})]}),(0,s.jsxs)("div",{className:"text-gray-600 text-xs",children:["Created:"," ",new Date(e.created_at).toLocaleDateString()," ",new Date(e.created_at).toLocaleTimeString()]}),(0,s.jsxs)("div",{className:"text-gray-600 text-xs",children:["Updated:"," ",new Date(e.updated_at).toLocaleDateString()," ",new Date(e.updated_at).toLocaleTimeString()]})]}),(0,s.jsxs)("div",{className:"mt-4 flex space-x-2",children:[(0,s.jsx)("button",{onClick:()=>{h(e),b(null),u(!0)},className:"px-3 py-1 bg-yellow-500 text-white rounded",children:"Edit"}),(0,s.jsx)("button",{onClick:()=>j(e.id),className:"px-3 py-1 bg-red-600 text-white rounded",children:"Delete"})]})]},e.id))}),(0,s.jsxs)("div",{className:"mt-8 flex justify-center space-x-4",children:[(0,s.jsx)("button",{onClick:()=>{c>1&&o(c-1)},disabled:1===c,className:"px-4 py-2 bg-indigo-600 text-white rounded disabled:opacity-50",children:"Previous"}),(0,s.jsxs)("span",{className:"px-4 py-2 text-black font-semibold",children:["Page ",c," of ",d]}),(0,s.jsx)("button",{onClick:()=>{c<d&&o(c+1)},disabled:c===d,className:"px-4 py-2 bg-indigo-600 text-white rounded disabled:opacity-50",children:"Next"})]})]}),m&&x&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,s.jsxs)("div",{className:"bg-white p-6 rounded-lg w-full max-w-lg shadow-lg overflow-y-auto max-h-screen text-black",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Edit Apartment Owner"}),(0,s.jsxs)("form",{onSubmit:N,encType:"multipart/form-data",children:[(0,s.jsx)("label",{className:"block mb-1 font-medium text-gray-700",children:"Name"}),(0,s.jsx)("input",{name:"name",defaultValue:x.name,className:"w-full p-2 mb-2 border text-black rounded",required:!0}),(0,s.jsx)("label",{className:"block mb-1 font-medium text-gray-700",children:"Address"}),(0,s.jsx)("input",{name:"address",defaultValue:x.address,className:"w-full p-2 mb-2 border text-black rounded",required:!0}),(0,s.jsx)("label",{className:"block mb-1 font-medium text-gray-700",children:"Status"}),(0,s.jsxs)("select",{name:"status",defaultValue:x.status||"",className:"w-full p-2 mb-4 border text-black rounded",children:[(0,s.jsx)("option",{value:"",children:"Select status"}),(0,s.jsx)("option",{value:"active",children:"Active"}),(0,s.jsx)("option",{value:"inactive",children:"Inactive"})]}),x.contract_path&&(0,s.jsxs)("div",{className:"mb-4 text-gray-800",children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-1 text-black",children:"Current Contract"}),(0,s.jsx)("div",{className:"flex items-center space-x-2",children:(0,s.jsx)("a",{href:"".concat(y,"/").concat(x.contract_path),target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 underline",children:"View / Download"})})]}),(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-1 text-gray-700",children:"Upload New Contract (optional)"}),(0,s.jsx)("input",{type:"file",accept:".pdf,.doc,.docx",name:"contract",onChange:e=>{let t=e.target.files;t&&t.length>0&&b(t[0])},className:"block w-full text-sm text-gray-700 file:mr-4 file:py-2 file:px-4 file:rounded file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100 border border-gray-300 rounded"})]}),(0,s.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,s.jsx)("button",{type:"button",onClick:()=>{u(!1),b(null)},className:"px-4 py-2 bg-gray-500 text-white rounded",children:"Cancel"}),(0,s.jsx)("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded",children:"Save Changes"})]})]})]})})]})}}},e=>{e.O(0,[8441,5964,7358],()=>e(e.s=2611)),_N_E=e.O()}]);