(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6947],{2462:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>s});var r=a(5155),n=a(2115),l=a(9509);function o(e){var t,a,o;let{existingOwner:s,onSuccess:c}=e,[d,i]=(0,n.useState)({name:null!=(t=null==s?void 0:s.name)?t:"",address:null!=(a=null==s?void 0:s.address)?a:"",contract:null,status:null!=(o=null==s?void 0:s.status)?o:""}),[u,m]=(0,n.useState)(""),[p,x]=(0,n.useState)(!1);(0,n.useEffect)(()=>{let e=localStorage.getItem("authToken");e&&m(e)},[]);let h=e=>{let{name:t,value:a}=e.target;i(e=>({...e,[t]:a}))},b=async()=>{if(s){if(!u)return void alert("Not authenticated");if(confirm("Remove existing contract?"))try{let e=await fetch("".concat("https://staging.livatrip.com/api","/apartment-owners/").concat(s.id,"/remove-contract"),{method:"POST",headers:{Authorization:"Bearer ".concat(u),"Content-Type":"application/json"},body:JSON.stringify({})});if(e.ok)alert("Contract removed."),c&&c();else{let t=await e.text();console.error("Failed to remove contract:",t),alert("Failed to remove contract.")}}catch(e){console.error("Error removing contract:",e),alert("Network error")}}},v=async e=>{if(e.preventDefault(),!u)return void alert("Not authenticated");x(!0);try{let e=new FormData;e.append("name",d.name),e.append("address",d.address),e.append("status",d.status),d.contract&&e.append("contract",d.contract);let t="".concat("https://staging.livatrip.com/api","/apartment-owners"),a="POST";s&&(t="".concat("https://staging.livatrip.com/api","/apartment-owners/").concat(s.id),e.append("_method","PUT"),a="POST");let r=await fetch(t,{method:a,headers:{Authorization:"Bearer ".concat(u)},body:e});if(r.ok)alert(s?"Apartment owner updated successfully!":"Apartment owner created successfully!"),s||i({name:"",address:"",contract:null,status:""}),c&&c();else{let e=await r.text();console.error("Server error:",e),alert("Failed to ".concat(s?"update":"create"," owner."))}}catch(e){console.error("Error submitting:",e),alert("Network error")}finally{x(!1)}};return(0,r.jsxs)("form",{onSubmit:v,className:"max-w-3xl mx-auto p-6 bg-white shadow-md rounded space-y-6 text-black",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:s?"Edit Apartment Owner":"Add New Apartment Owner"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-900 mb-1",children:"Name"}),(0,r.jsx)("input",{type:"text",name:"name",value:d.name,onChange:h,required:!0,className:"w-full p-2 border border-gray-300 rounded"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-900 mb-1",children:"Address"}),(0,r.jsx)("input",{type:"text",name:"address",value:d.address,onChange:h,required:!0,className:"w-full p-2 border border-gray-300 rounded"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-900 mb-1",children:"Status"}),(0,r.jsxs)("select",{name:"status",value:d.status,onChange:h,required:!0,className:"w-full p-2 border border-gray-300 rounded",children:[(0,r.jsx)("option",{value:"",children:"Select Status"}),(0,r.jsx)("option",{value:"active",children:"Active"}),(0,r.jsx)("option",{value:"inactive",children:"Inactive"})]})]}),s&&s.contract_path&&(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-900 mb-1",children:"Current Contract"}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("a",{href:"".concat(l.env.NEXT_PUBLIC_FILE_BASE_URL_STORAGE,"/").concat(s.contract_path),target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 underline",children:"View / Download"}),(0,r.jsx)("button",{type:"button",onClick:b,className:"px-2 py-1 bg-red-600 text-white text-xs rounded",children:"Remove"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-900 mb-1",children:s?"Replace Contract (optional)":"Contract Document"}),(0,r.jsx)("input",{type:"file",name:"contract",accept:".pdf,.doc,.docx",onChange:e=>{var t,a;let r=null!=(a=null==(t=e.target.files)?void 0:t[0])?a:null;i(e=>({...e,contract:r}))},className:"block w-full text-sm text-gray-900 border border-gray-300 rounded cursor-pointer bg-gray-50"})]}),(0,r.jsx)("div",{children:(0,r.jsx)("button",{type:"submit",disabled:p,className:"w-full py-3 text-white rounded ".concat(p?"bg-gray-400":"bg-blue-700 hover:bg-blue-800"),children:p?s?"Updating...":"Submitting...":s?"Save Changes":"Submit Apartment Owner"})})]})}function s(){return(0,r.jsx)("div",{className:"p-6",children:(0,r.jsx)(o,{})})}},9217:(e,t,a)=>{Promise.resolve().then(a.bind(a,2462))}},e=>{var t=t=>e(e.s=t);e.O(0,[8441,1684,7358],()=>t(9217)),_N_E=e.O()}]);